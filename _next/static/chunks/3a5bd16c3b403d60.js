(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},59544,3812,67073,32098,39964,6661,e=>{"use strict";var t=e.i(43476),s=e.i(932);function a(e){let a,l,r,n,c,d,i,o,x=(0,s.c)(12);x[0]!==e?({children:a,variant:r,size:n,className:c,...l}=e,x[0]=e,x[1]=a,x[2]=l,x[3]=r,x[4]=n,x[5]=c):(a=x[1],l=x[2],r=x[3],n=x[4],c=x[5]);let m=void 0===r?"primary":r,u=void 0===n?"md":n,h=void 0===c?"":c;x[6]===Symbol.for("react.memo_cache_sentinel")?(d={primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-slate-700 hover:bg-slate-600 text-slate-200",danger:"bg-red-600 hover:bg-red-700 text-white",success:"bg-green-600 hover:bg-green-700 text-white"},x[6]=d):d=x[6];let p=d;x[7]===Symbol.for("react.memo_cache_sentinel")?(i={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},x[7]=i):i=x[7];let f=i,b=`inline-flex items-center justify-center font-medium rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap ${p[m]} ${f[u]} ${h}`;return x[8]!==a||x[9]!==l||x[10]!==b?(o=(0,t.jsx)("button",{className:b,...l,children:a}),x[8]=a,x[9]=l,x[10]=b,x[11]=o):o=x[11],o}e.s(["Button",()=>a],59544);var l=e.i(71645);let r=(0,l.forwardRef)(({label:e,error:s,className:a="",...l},r)=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:e}),(0,t.jsx)("input",{ref:r,className:`w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${s?"border-red-500":""} ${a}`,...l}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:s})]}));r.displayName="Input",e.s(["Input",0,r],3812);let n=(0,l.forwardRef)(({label:e,error:s,options:a,className:l="",...r},n)=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:e}),(0,t.jsxs)("select",{ref:n,className:`w-full px-3 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors cursor-pointer appearance-none bg-no-repeat bg-right pr-10 ${s?"border-red-500":""} ${l}`,style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2394a3b8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\")",backgroundSize:"1.5rem",backgroundPosition:"right 0.5rem center"},...r,children:[(0,t.jsx)("option",{value:"",disabled:!0,className:"bg-slate-800 text-slate-400",children:"Seleccionar..."}),a.map(e=>(0,t.jsx)("option",{value:e.value,className:"bg-slate-800 text-slate-100 py-2",children:e.label},e.value))]}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:s})]}));n.displayName="Select",e.s(["Select",0,n],67073);var c=e.i(37727);function d(e){let a,r,n,d,i,o,x,m,u,h,p=(0,s.c)(22),{isOpen:f,onClose:b,title:g,children:j}=e;return(p[0]!==f||p[1]!==b?(a=()=>{let e=e=>{"Escape"===e.key&&b()};return f&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},r=[f,b],p[0]=f,p[1]=b,p[2]=a,p[3]=r):(a=p[2],r=p[3]),(0,l.useEffect)(a,r),f)?(p[4]!==b?(n=(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:b}),p[4]=b,p[5]=n):n=p[5],p[6]!==g?(d=(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-100",children:g}),p[6]=g,p[7]=d):d=p[7],p[8]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsx)(c.X,{className:"w-5 h-5 text-slate-400"}),p[8]=i):i=p[8],p[9]!==b?(o=(0,t.jsx)("button",{onClick:b,className:"p-1 rounded-lg hover:bg-slate-700 transition-colors",children:i}),p[9]=b,p[10]=o):o=p[10],p[11]!==d||p[12]!==o?(x=(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-700",children:[d,o]}),p[11]=d,p[12]=o,p[13]=x):x=p[13],p[14]!==j?(m=(0,t.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:j}),p[14]=j,p[15]=m):m=p[15],p[16]!==x||p[17]!==m?(u=(0,t.jsxs)("div",{className:"relative bg-slate-800 rounded-xl shadow-2xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden",children:[x,m]}),p[16]=x,p[17]=m,p[18]=u):u=p[18],p[19]!==n||p[20]!==u?(h=(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n,u]}),p[19]=n,p[20]=u,p[21]=h):h=p[21],h):null}function i(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,c=`bg-slate-800 rounded-xl border border-slate-700 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==c?(a=(0,t.jsx)("div",{className:c,children:r}),l[0]=r,l[1]=c,l[2]=a):a=l[2],a}function o(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,c=`px-6 py-4 border-b border-slate-700 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==c?(a=(0,t.jsx)("div",{className:c,children:r}),l[0]=r,l[1]=c,l[2]=a):a=l[2],a}function x(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,c=`p-6 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==c?(a=(0,t.jsx)("div",{className:c,children:r}),l[0]=r,l[1]=c,l[2]=a):a=l[2],a}e.s(["Modal",()=>d],32098),e.s(["Card",()=>i,"CardContent",()=>x,"CardHeader",()=>o],39964);let m=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var u=e.i(31278),h=e.i(7471);function p({value:e,onChange:s,onRemove:a}){let[r,n]=(0,l.useState)(!1),[d,i]=(0,l.useState)(null),o=(0,l.useRef)(null);async function x(e){let t=e.target.files?.[0];if(t){if(!t.type.startsWith("image/"))return void i("Solo se permiten imágenes");if(t.size>5242880)return void i("La imagen no debe superar 5MB");n(!0),i(null);try{let e=t.name.split(".").pop(),a=`${Date.now()}-${Math.random().toString(36).substring(2)}.${e}`,l=`productos/${a}`,{error:r}=await h.supabase.storage.from("imagenes").upload(l,t);if(r)throw r;let{data:n}=h.supabase.storage.from("imagenes").getPublicUrl(l);s(n.publicUrl)}catch(e){console.error("Error uploading image:",e),i(e.message||"Error al subir la imagen")}finally{n(!1),o.current&&(o.current.value="")}}}async function p(){if(!e)return;let t=e.split("/imagenes/");if(t.length>1){let e=t[1];await h.supabase.storage.from("imagenes").remove([e])}a?.(),s("")}return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Imagen del producto"}),e?(0,t.jsxs)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border border-slate-600",children:[(0,t.jsx)("img",{src:e,alt:"Producto",className:"w-full h-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:p,className:"absolute top-2 right-2 p-1.5 bg-red-600 hover:bg-red-700 rounded-full transition-colors",children:(0,t.jsx)(c.X,{className:"w-4 h-4 text-white"})})]}):(0,t.jsxs)("label",{className:`flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-slate-600 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-slate-800/50 transition-colors ${r?"pointer-events-none opacity-50":""}`,children:[(0,t.jsx)("input",{ref:o,type:"file",accept:"image/*",onChange:x,className:"hidden",disabled:r}),r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Loader2,{className:"w-10 h-10 text-blue-500 animate-spin mb-2"}),(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"Subiendo imagen..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-3 bg-slate-700 rounded-full mb-3",children:(0,t.jsx)(m,{className:"w-6 h-6 text-slate-400"})}),(0,t.jsx)("span",{className:"text-sm text-slate-300 font-medium",children:"Clic para subir imagen"}),(0,t.jsx)("span",{className:"text-xs text-slate-500 mt-1",children:"PNG, JPG hasta 5MB"})]})]}),d&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-400",children:d})]})}e.s(["ImageUpload",()=>p],6661)},38378,84614,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(55436),l=e.i(88844),r=e.i(37727);function n({productos:e,onSelect:n,formatearPrecio:c}){let[d,i]=(0,s.useState)(""),[o,x]=(0,s.useState)(!1),[m,u]=(0,s.useState)(0),h=(0,s.useRef)(null),p=(0,s.useRef)(null),f=d.trim()?e.filter(e=>e.nombre.toLowerCase().includes(d.toLowerCase())||e.descripcion?.toLowerCase().includes(d.toLowerCase())).slice(0,8):e.slice(0,8);function b(e){e.stock<=0||(n(e),i(""),h.current?.focus(),x(!1))}return(0,s.useEffect)(()=>{u(0)},[d]),(0,s.useEffect)(()=>{if(m>=0&&p.current){let e=p.current.children[m];e&&e.scrollIntoView({block:"nearest"})}},[m]),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,t.jsx)("input",{ref:h,type:"text",value:d,onChange:e=>{i(e.target.value),x(!0)},onFocus:()=>x(!0),onKeyDown:function(e){if(!o){("ArrowDown"===e.key||"Enter"===e.key)&&x(!0);return}switch(e.key){case"ArrowDown":e.preventDefault(),u(e=>e<f.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),u(e=>e>0?e-1:0);break;case"Enter":e.preventDefault(),f[m]&&b(f[m]);break;case"Escape":x(!1)}},placeholder:"Buscar producto por nombre...",className:"w-full pl-10 pr-10 py-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),d&&(0,t.jsx)("button",{type:"button",onClick:()=>{i(""),h.current?.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-600 rounded",children:(0,t.jsx)(r.X,{className:"w-4 h-4 text-slate-400"})})]}),o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),(0,t.jsxs)("div",{ref:p,className:"absolute z-20 w-full mt-2 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-80 overflow-y-auto",children:[0===f.length?(0,t.jsx)("div",{className:"p-4 text-center text-slate-400",children:"No se encontraron productos"}):f.map((e,s)=>(0,t.jsxs)("button",{type:"button",onClick:()=>b(e),disabled:e.stock<=0,className:`w-full flex items-center gap-3 p-3 text-left transition-colors ${s===m?"bg-blue-600/30":"hover:bg-slate-700/50"} ${e.stock<=0?"opacity-50 cursor-not-allowed":""} ${s!==f.length-1?"border-b border-slate-700/50":""}`,children:[e.imagen_url?(0,t.jsx)("img",{src:e.imagen_url,alt:e.nombre,className:"w-12 h-12 rounded-lg object-cover flex-shrink-0"}):(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg bg-slate-700 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.Package,{className:"w-6 h-6 text-slate-500"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-slate-100 truncate",children:e.nombre}),e.descripcion&&(0,t.jsx)("p",{className:"text-sm text-slate-400 truncate",children:e.descripcion}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-green-400",children:c(e.precio)}),(0,t.jsx)("span",{className:`text-xs px-1.5 py-0.5 rounded ${e.stock>10?"bg-green-900/50 text-green-400":e.stock>0?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:e.stock>0?`Stock: ${e.stock}`:"Sin stock"})]})]})]},e.id)),e.length>8&&!d&&(0,t.jsxs)("div",{className:"p-2 text-center text-xs text-slate-500 border-t border-slate-700",children:["Escribe para buscar entre ",e.length," productos"]})]})]})]})}e.s(["ProductSearch",()=>n],38378);let c=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>c],84614)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},16787,64601,e=>{"use strict";e.i(59544),e.i(3812),e.i(67073),e.i(32098),e.i(39964),e.i(6661),e.i(38378);var t=e.i(43476),s=e.i(932),a=e.i(71645),l=e.i(84614),r=e.i(7233);function n(e){let n,c,d,i,o,x,m,u,h,p,f,b=(0,s.c)(25),{clientes:g,value:j,onChange:N,placeholder:v}=e,y=void 0===v?"Buscar o escribir nombre del cliente...":v,[w,C]=(0,a.useState)(!1),[_,k]=(0,a.useState)(0),S=(0,a.useRef)(null),$=(0,a.useRef)(null),E=j.trim()?g.filter(e=>e.nombre.toLowerCase().includes(j.toLowerCase().trim())):g;if(b[0]!==g||b[1]!==j){let e;b[3]!==j?(e=e=>e.nombre.toLowerCase()===j.toLowerCase().trim(),b[3]=j,b[4]=e):e=b[4],n=g.some(e),b[0]=g,b[1]=j,b[2]=n}else n=b[2];let L=n;b[5]!==L||b[6]!==j?(c=j.trim()&&!L,b[5]=L,b[6]=j,b[7]=c):c=b[7];let M=c;b[8]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{let e=function(e){S.current&&!S.current.contains(e.target)&&C(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},i=[],b[8]=d,b[9]=i):(d=b[8],i=b[9]),(0,a.useEffect)(d,i),b[10]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{k(0)},b[10]=o):o=b[10],b[11]!==j?(x=[j],b[11]=j,b[12]=x):x=b[12],(0,a.useEffect)(o,x);let D=function(e){let t=E.length+ +!!M;if("ArrowDown"===e.key)e.preventDefault(),C(!0),k(e=>(e+1)%t);else if("ArrowUp"===e.key)e.preventDefault(),C(!0),k(e=>(e-1+t)%t);else if("Enter"===e.key&&w)if(e.preventDefault(),M&&0===_)C(!1);else{let e=M?_-1:_;E[e]&&(N(E[e].nombre),C(!1))}else"Escape"===e.key&&C(!1)},P=function(e){N(e),C(!1),$.current?.focus()};b[13]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(l.User,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),b[13]=m):m=b[13],b[14]!==N?(u=e=>{N(e.target.value),C(!0)},b[14]=N,b[15]=u):u=b[15],b[16]===Symbol.for("react.memo_cache_sentinel")?(h=()=>C(!0),b[16]=h):h=b[16],b[17]!==D||b[18]!==y||b[19]!==u||b[20]!==j?(p=(0,t.jsxs)("div",{className:"relative",children:[m,(0,t.jsx)("input",{ref:$,type:"text",value:j,onChange:u,onFocus:h,onKeyDown:D,placeholder:y,className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),b[17]=D,b[18]=y,b[19]=u,b[20]=j,b[21]=p):p=b[21];let U=w&&(E.length>0||M)&&(0,t.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-slate-800 border border-slate-600 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:[M&&(0,t.jsxs)("button",{type:"button",onClick:()=>{C(!1)},className:`w-full px-4 py-3 flex items-center gap-3 text-left transition-colors border-b border-slate-700 ${0===_?"bg-blue-600/30":"hover:bg-slate-700/50"}`,children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-600/30 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(r.Plus,{className:"w-4 h-4 text-green-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-green-400 font-medium",children:"Crear nuevo cliente"}),(0,t.jsxs)("p",{className:"text-slate-300 font-medium",children:['"',j.trim(),'"']})]})]}),E.map((e,s)=>{let a=M?s+1:s;return(0,t.jsxs)("button",{type:"button",onClick:()=>P(e.nombre),className:`w-full px-4 py-3 flex items-center gap-3 text-left transition-colors ${_===a?"bg-slate-700":"hover:bg-slate-700/50"}`,children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.User,{className:"w-4 h-4 text-slate-300"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-slate-100 font-medium truncate",children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Cliente registrado"})]})]},e.id)}),0===E.length&&!M&&(0,t.jsx)("div",{className:"px-4 py-3 text-center text-slate-400 text-sm",children:"No se encontraron clientes"})]});return b[22]!==p||b[23]!==U?(f=(0,t.jsxs)("div",{ref:S,className:"relative",children:[p,U]}),b[22]=p,b[23]=U,b[24]=f):f=b[24],f}e.s(["ClienteSearch",()=>n],64601),e.s([],16787)},73375,63059,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>s],73375);let a=(0,t.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>a],63059)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},48128,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(61911),l=e.i(55436),r=e.i(1928),n=e.i(73375),c=e.i(63059),d=e.i(87316),i=e.i(63209),o=e.i(7471);e.i(16787);var x=e.i(39964),m=e.i(91193);function u(){let[e,u]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[f,b]=(0,s.useState)(""),[g,j]=(0,s.useState)(1),{formatearPrecio:N}=(0,m.useMoneda)();async function v(){let[e,t]=await Promise.all([o.supabase.from("clientes").select("*").order("nombre"),o.supabase.from("ventas").select("cliente_nombre, total, total_pagado, estado, created_at").order("created_at",{ascending:!1})]);if(e.error){console.error("Error fetching clientes:",e.error),p(!1);return}let s=e.data||[],a=t.data||[],l={};a.forEach(e=>{let t=e.cliente_nombre.toLowerCase();l[t]||(l[t]={total_compras:0,total_facturado:0,total_pagado:0,ultima_compra:null}),l[t].total_compras++,l[t].total_facturado+=e.total,l[t].total_pagado+=e.total_pagado||0,l[t].ultima_compra||(l[t].ultima_compra=e.created_at)});let r=s.map(e=>{let t=l[e.nombre.toLowerCase()]||{total_compras:0,total_facturado:0,total_pagado:0,ultima_compra:null},s=t.total_facturado-t.total_pagado;return{...e,total_compras:t.total_compras,total_facturado:t.total_facturado,total_pagado:t.total_pagado,deuda_pendiente:s,tiene_deuda:s>0,ultima_compra:t.ultima_compra}});r.sort((e,t)=>e.tiene_deuda&&!t.tiene_deuda?-1:!e.tiene_deuda&&t.tiene_deuda?1:e.deuda_pendiente!==t.deuda_pendiente?t.deuda_pendiente-e.deuda_pendiente:t.total_facturado-e.total_facturado),u(r),p(!1)}(0,s.useEffect)(()=>{v()},[]);let y=(0,s.useMemo)(()=>{if(!f.trim())return e;let t=f.toLowerCase().trim();return e.filter(e=>e.nombre.toLowerCase().includes(t))},[e,f]),w=Math.ceil(y.length/15),C=(0,s.useMemo)(()=>{let e=(g-1)*15;return y.slice(e,e+15)},[y,g]);(0,s.useEffect)(()=>{j(1)},[f]);let _=e.length,k=e.reduce((e,t)=>e+t.total_compras,0),S=e.reduce((e,t)=>e+t.total_facturado,0),$=e.reduce((e,t)=>e+t.total_pagado,0),E=e.reduce((e,t)=>e+t.deuda_pendiente,0),L=e.filter(e=>e.tiene_deuda).length;return h?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"text-slate-400",children:"Cargando..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:(0,t.jsx)("p",{className:"text-slate-400 text-sm sm:text-base",children:"Clientes registrados automáticamente al realizar ventas"})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:[(0,t.jsx)(x.Card,{children:(0,t.jsx)(x.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-600/20 flex items-center justify-center",children:(0,t.jsx)(a.Users,{className:"w-5 h-5 text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:_}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Clientes"})]})]})})}),(0,t.jsx)(x.Card,{children:(0,t.jsx)(x.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-600/20 flex items-center justify-center",children:(0,t.jsx)(r.ShoppingCart,{className:"w-5 h-5 text-purple-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:k}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Ventas"})]})]})})}),(0,t.jsx)(x.Card,{children:(0,t.jsx)(x.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-slate-600/20 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-slate-400 font-bold",children:"$"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xl font-bold text-slate-100",children:N(S)}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Facturado"})]})]})})}),(0,t.jsx)(x.Card,{children:(0,t.jsx)(x.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-600/20 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-green-400 font-bold",children:"$"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xl font-bold text-green-400",children:N($)}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Cobrado"})]})]})})}),(0,t.jsx)(x.Card,{className:E>0?"border-red-500/50":"",children:(0,t.jsx)(x.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-red-600/20 flex items-center justify-center",children:(0,t.jsx)(i.AlertCircle,{className:"w-5 h-5 text-red-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xl font-bold text-red-400",children:N(E)}),(0,t.jsxs)("p",{className:"text-sm text-slate-400",children:["Pendiente (",L,")"]})]})]})})})]}),(0,t.jsx)(x.Card,{children:(0,t.jsxs)(x.CardContent,{className:"py-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar cliente por nombre...",value:f,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-slate-400",children:["Mostrando ",y.length," de ",e.length," clientes"]})]})}),0===y.length?(0,t.jsx)(x.Card,{children:(0,t.jsxs)(x.CardContent,{className:"text-center py-12",children:[(0,t.jsx)(a.Users,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-400",children:0===e.length?"No hay clientes registrados. Se crearán automáticamente al registrar ventas.":"No se encontraron clientes con ese nombre"})]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"hidden lg:block bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Cliente"}),(0,t.jsx)("th",{className:"text-center px-6 py-4 text-sm font-medium text-slate-400",children:"Compras"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Facturado"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Pagado"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Pendiente"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Última compra"})]})}),(0,t.jsx)("tbody",{children:C.map(e=>{var s;return(0,t.jsxs)("tr",{className:`border-b border-slate-700/50 hover:bg-slate-700/30 transition-colors ${e.tiene_deuda?"bg-red-900/10":""}`,children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${e.tiene_deuda?"bg-red-900/50":"bg-slate-700"}`,children:(0,t.jsx)("span",{className:`font-medium text-sm ${e.tiene_deuda?"text-red-300":"text-slate-300"}`,children:e.nombre.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-slate-100",children:e.nombre}),e.tiene_deuda&&(0,t.jsxs)("span",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,t.jsx)(i.AlertCircle,{className:"w-3 h-3"}),"Tiene deuda pendiente"]})]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 text-center",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded-md text-sm ${e.total_compras>5?"bg-green-900/50 text-green-400":e.total_compras>0?"bg-blue-900/50 text-blue-400":"bg-slate-700 text-slate-400"}`,children:e.total_compras})}),(0,t.jsxs)("td",{className:"px-6 py-4 text-right",children:[(0,t.jsx)("p",{className:"font-semibold text-slate-300",children:N(e.total_facturado)}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["$ ",e.total_facturado.toFixed(2)," USD"]})]}),(0,t.jsxs)("td",{className:"px-6 py-4 text-right",children:[(0,t.jsx)("p",{className:"font-semibold text-green-400",children:N(e.total_pagado)}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["$ ",e.total_pagado.toFixed(2)," USD"]})]}),(0,t.jsx)("td",{className:"px-6 py-4 text-right",children:e.tiene_deuda?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"font-semibold text-red-400",children:N(e.deuda_pendiente)}),(0,t.jsxs)("p",{className:"text-xs text-red-500",children:["$ ",e.deuda_pendiente.toFixed(2)," USD"]})]}):(0,t.jsx)("span",{className:"px-2 py-1 rounded-md text-xs bg-green-900/50 text-green-400",children:"Al día"})}),(0,t.jsx)("td",{className:"px-6 py-4 text-right text-slate-300 text-sm",children:(s=e.ultima_compra)?new Date(s).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"Sin compras"})]},e.id)})})]})}),(0,t.jsx)("div",{className:"lg:hidden space-y-4",children:C.map(e=>(0,t.jsx)(x.Card,{className:e.tiene_deuda?"border-red-500/50":"",children:(0,t.jsxs)(x.CardContent,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 ${e.tiene_deuda?"bg-red-900/50":"bg-slate-700"}`,children:(0,t.jsx)("span",{className:`font-medium text-lg ${e.tiene_deuda?"text-red-300":"text-slate-300"}`,children:e.nombre.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-slate-100 truncate",children:e.nombre}),(0,t.jsxs)("p",{className:"text-xs text-slate-400 flex items-center gap-1 mt-1",children:[(0,t.jsx)(d.Calendar,{className:"w-3 h-3"}),new Date(e.created_at).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"})]}),e.tiene_deuda&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-0.5 rounded-full text-xs bg-red-900/50 text-red-400",children:[(0,t.jsx)(i.AlertCircle,{className:"w-3 h-3"}),"Deuda pendiente"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-2 mt-4 pt-4 border-t border-slate-700 items-center",children:[(0,t.jsxs)("div",{className:"text-center w-full h-full",children:[(0,t.jsx)("p",{className:"text-sm font-bold text-blue-400",children:e.total_compras}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Compras"})]}),(0,t.jsxs)("div",{className:"text-center w-full h-full",children:[(0,t.jsx)("p",{className:"text-sm font-bold text-slate-300",children:N(e.total_facturado)}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Facturado"})]}),(0,t.jsxs)("div",{className:"text-center w-full h-full",children:[(0,t.jsx)("p",{className:"text-sm font-bold text-green-400",children:N(e.total_pagado)}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Pagado"})]}),(0,t.jsx)("div",{className:"text-center w-full h-full",children:e.tiene_deuda?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-sm font-bold text-red-400",children:N(e.deuda_pendiente)}),(0,t.jsx)("p",{className:"text-xs text-red-400",children:"Debe"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-sm font-bold text-green-400",children:"✓"}),(0,t.jsx)("p",{className:"text-xs text-green-400",children:"Al día"})]})})]})]})},e.id))}),w>1&&(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 pt-4",children:[(0,t.jsxs)("p",{className:"text-sm text-slate-400",children:["Página ",g," de ",w]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>j(1),disabled:1===g,className:"px-3 py-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:"Primera"}),(0,t.jsx)("button",{onClick:()=>j(e=>Math.max(1,e-1)),disabled:1===g,className:"p-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,t.jsx)(n.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,w)},(e,s)=>{let a;return a=w<=5||g<=3?s+1:g>=w-2?w-4+s:g-2+s,(0,t.jsx)("button",{onClick:()=>j(a),className:`w-8 h-8 rounded-lg text-sm transition-colors ${g===a?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:a},a)})}),(0,t.jsx)("button",{onClick:()=>j(e=>Math.min(w,e+1)),disabled:g===w,className:"p-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,t.jsx)(c.ChevronRight,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>j(w),disabled:g===w,className:"px-3 py-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:"Última"})]})]})]})]})}e.s(["default",()=>u])}]);