(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},59544,3812,67073,32098,39964,6661,e=>{"use strict";var t=e.i(43476),s=e.i(932);function a(e){let a,l,r,n,o,i,c,d,m=(0,s.c)(12);m[0]!==e?({children:a,variant:r,size:n,className:o,...l}=e,m[0]=e,m[1]=a,m[2]=l,m[3]=r,m[4]=n,m[5]=o):(a=m[1],l=m[2],r=m[3],n=m[4],o=m[5]);let u=void 0===r?"primary":r,x=void 0===n?"md":n,h=void 0===o?"":o;m[6]===Symbol.for("react.memo_cache_sentinel")?(i={primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-slate-700 hover:bg-slate-600 text-slate-200",danger:"bg-red-600 hover:bg-red-700 text-white",success:"bg-green-600 hover:bg-green-700 text-white"},m[6]=i):i=m[6];let p=i;m[7]===Symbol.for("react.memo_cache_sentinel")?(c={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},m[7]=c):c=m[7];let f=c,b=`inline-flex items-center justify-center font-medium rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap ${p[u]} ${f[x]} ${h}`;return m[8]!==a||m[9]!==l||m[10]!==b?(d=(0,t.jsx)("button",{className:b,...l,children:a}),m[8]=a,m[9]=l,m[10]=b,m[11]=d):d=m[11],d}e.s(["Button",()=>a],59544);var l=e.i(71645);let r=(0,l.forwardRef)(({label:e,error:s,className:a="",...l},r)=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:e}),(0,t.jsx)("input",{ref:r,className:`w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${s?"border-red-500":""} ${a}`,...l}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:s})]}));r.displayName="Input",e.s(["Input",0,r],3812);let n=(0,l.forwardRef)(({label:e,error:s,options:a,className:l="",...r},n)=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:e}),(0,t.jsxs)("select",{ref:n,className:`w-full px-3 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors cursor-pointer appearance-none bg-no-repeat bg-right pr-10 ${s?"border-red-500":""} ${l}`,style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2394a3b8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\")",backgroundSize:"1.5rem",backgroundPosition:"right 0.5rem center"},...r,children:[(0,t.jsx)("option",{value:"",disabled:!0,className:"bg-slate-800 text-slate-400",children:"Seleccionar..."}),a.map(e=>(0,t.jsx)("option",{value:e.value,className:"bg-slate-800 text-slate-100 py-2",children:e.label},e.value))]}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:s})]}));n.displayName="Select",e.s(["Select",0,n],67073);var o=e.i(37727);function i(e){let a,r,n,i,c,d,m,u,x,h,p=(0,s.c)(22),{isOpen:f,onClose:b,title:g,children:v}=e;return(p[0]!==f||p[1]!==b?(a=()=>{let e=e=>{"Escape"===e.key&&b()};return f&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},r=[f,b],p[0]=f,p[1]=b,p[2]=a,p[3]=r):(a=p[2],r=p[3]),(0,l.useEffect)(a,r),f)?(p[4]!==b?(n=(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:b}),p[4]=b,p[5]=n):n=p[5],p[6]!==g?(i=(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-100",children:g}),p[6]=g,p[7]=i):i=p[7],p[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)(o.X,{className:"w-5 h-5 text-slate-400"}),p[8]=c):c=p[8],p[9]!==b?(d=(0,t.jsx)("button",{onClick:b,className:"p-1 rounded-lg hover:bg-slate-700 transition-colors",children:c}),p[9]=b,p[10]=d):d=p[10],p[11]!==i||p[12]!==d?(m=(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-700",children:[i,d]}),p[11]=i,p[12]=d,p[13]=m):m=p[13],p[14]!==v?(u=(0,t.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:v}),p[14]=v,p[15]=u):u=p[15],p[16]!==m||p[17]!==u?(x=(0,t.jsxs)("div",{className:"relative bg-slate-800 rounded-xl shadow-2xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden",children:[m,u]}),p[16]=m,p[17]=u,p[18]=x):x=p[18],p[19]!==n||p[20]!==x?(h=(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n,x]}),p[19]=n,p[20]=x,p[21]=h):h=p[21],h):null}function c(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,o=`bg-slate-800 rounded-xl border border-slate-700 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==o?(a=(0,t.jsx)("div",{className:o,children:r}),l[0]=r,l[1]=o,l[2]=a):a=l[2],a}function d(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,o=`px-6 py-4 border-b border-slate-700 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==o?(a=(0,t.jsx)("div",{className:o,children:r}),l[0]=r,l[1]=o,l[2]=a):a=l[2],a}function m(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,o=`p-6 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==o?(a=(0,t.jsx)("div",{className:o,children:r}),l[0]=r,l[1]=o,l[2]=a):a=l[2],a}e.s(["Modal",()=>i],32098),e.s(["Card",()=>c,"CardContent",()=>m,"CardHeader",()=>d],39964);let u=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var x=e.i(31278),h=e.i(7471);function p({value:e,onChange:s,onRemove:a}){let[r,n]=(0,l.useState)(!1),[i,c]=(0,l.useState)(null),d=(0,l.useRef)(null);async function m(e){let t=e.target.files?.[0];if(t){if(!t.type.startsWith("image/"))return void c("Solo se permiten imágenes");if(t.size>5242880)return void c("La imagen no debe superar 5MB");n(!0),c(null);try{let e=t.name.split(".").pop(),a=`${Date.now()}-${Math.random().toString(36).substring(2)}.${e}`,l=`productos/${a}`,{error:r}=await h.supabase.storage.from("imagenes").upload(l,t);if(r)throw r;let{data:n}=h.supabase.storage.from("imagenes").getPublicUrl(l);s(n.publicUrl)}catch(e){console.error("Error uploading image:",e),c(e.message||"Error al subir la imagen")}finally{n(!1),d.current&&(d.current.value="")}}}async function p(){if(!e)return;let t=e.split("/imagenes/");if(t.length>1){let e=t[1];await h.supabase.storage.from("imagenes").remove([e])}a?.(),s("")}return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Imagen del producto"}),e?(0,t.jsxs)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border border-slate-600",children:[(0,t.jsx)("img",{src:e,alt:"Producto",className:"w-full h-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:p,className:"absolute top-2 right-2 p-1.5 bg-red-600 hover:bg-red-700 rounded-full transition-colors",children:(0,t.jsx)(o.X,{className:"w-4 h-4 text-white"})})]}):(0,t.jsxs)("label",{className:`flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-slate-600 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-slate-800/50 transition-colors ${r?"pointer-events-none opacity-50":""}`,children:[(0,t.jsx)("input",{ref:d,type:"file",accept:"image/*",onChange:m,className:"hidden",disabled:r}),r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Loader2,{className:"w-10 h-10 text-blue-500 animate-spin mb-2"}),(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"Subiendo imagen..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-3 bg-slate-700 rounded-full mb-3",children:(0,t.jsx)(u,{className:"w-6 h-6 text-slate-400"})}),(0,t.jsx)("span",{className:"text-sm text-slate-300 font-medium",children:"Clic para subir imagen"}),(0,t.jsx)("span",{className:"text-xs text-slate-500 mt-1",children:"PNG, JPG hasta 5MB"})]})]}),i&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-400",children:i})]})}e.s(["ImageUpload",()=>p],6661)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},38378,84614,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(55436),l=e.i(88844),r=e.i(37727);function n({productos:e,onSelect:n,formatearPrecio:o}){let[i,c]=(0,s.useState)(""),[d,m]=(0,s.useState)(!1),[u,x]=(0,s.useState)(0),h=(0,s.useRef)(null),p=(0,s.useRef)(null),f=i.trim()?e.filter(e=>e.nombre.toLowerCase().includes(i.toLowerCase())||e.descripcion?.toLowerCase().includes(i.toLowerCase())).slice(0,8):e.slice(0,8);function b(e){e.stock<=0||(n(e),c(""),h.current?.focus(),m(!1))}return(0,s.useEffect)(()=>{x(0)},[i]),(0,s.useEffect)(()=>{if(u>=0&&p.current){let e=p.current.children[u];e&&e.scrollIntoView({block:"nearest"})}},[u]),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,t.jsx)("input",{ref:h,type:"text",value:i,onChange:e=>{c(e.target.value),m(!0)},onFocus:()=>m(!0),onKeyDown:function(e){if(!d){("ArrowDown"===e.key||"Enter"===e.key)&&m(!0);return}switch(e.key){case"ArrowDown":e.preventDefault(),x(e=>e<f.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),x(e=>e>0?e-1:0);break;case"Enter":e.preventDefault(),f[u]&&b(f[u]);break;case"Escape":m(!1)}},placeholder:"Buscar producto por nombre...",className:"w-full pl-10 pr-10 py-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),i&&(0,t.jsx)("button",{type:"button",onClick:()=>{c(""),h.current?.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-600 rounded",children:(0,t.jsx)(r.X,{className:"w-4 h-4 text-slate-400"})})]}),d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>m(!1)}),(0,t.jsxs)("div",{ref:p,className:"absolute z-20 w-full mt-2 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-80 overflow-y-auto",children:[0===f.length?(0,t.jsx)("div",{className:"p-4 text-center text-slate-400",children:"No se encontraron productos"}):f.map((e,s)=>(0,t.jsxs)("button",{type:"button",onClick:()=>b(e),disabled:e.stock<=0,className:`w-full flex items-center gap-3 p-3 text-left transition-colors ${s===u?"bg-blue-600/30":"hover:bg-slate-700/50"} ${e.stock<=0?"opacity-50 cursor-not-allowed":""} ${s!==f.length-1?"border-b border-slate-700/50":""}`,children:[e.imagen_url?(0,t.jsx)("img",{src:e.imagen_url,alt:e.nombre,className:"w-12 h-12 rounded-lg object-cover flex-shrink-0"}):(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg bg-slate-700 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.Package,{className:"w-6 h-6 text-slate-500"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-slate-100 truncate",children:e.nombre}),e.descripcion&&(0,t.jsx)("p",{className:"text-sm text-slate-400 truncate",children:e.descripcion}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-green-400",children:o(e.precio)}),(0,t.jsx)("span",{className:`text-xs px-1.5 py-0.5 rounded ${e.stock>10?"bg-green-900/50 text-green-400":e.stock>0?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:e.stock>0?`Stock: ${e.stock}`:"Sin stock"})]})]})]},e.id)),e.length>8&&!i&&(0,t.jsxs)("div",{className:"p-2 text-center text-xs text-slate-500 border-t border-slate-700",children:["Escribe para buscar entre ",e.length," productos"]})]})]})]})}e.s(["ProductSearch",()=>n],38378);let o=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>o],84614)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},16787,64601,e=>{"use strict";e.i(59544),e.i(3812),e.i(67073),e.i(32098),e.i(39964),e.i(6661),e.i(38378);var t=e.i(43476),s=e.i(932),a=e.i(71645),l=e.i(84614),r=e.i(7233);function n(e){let n,o,i,c,d,m,u,x,h,p,f,b=(0,s.c)(25),{clientes:g,value:v,onChange:j,placeholder:y}=e,N=void 0===y?"Buscar o escribir nombre del cliente...":y,[w,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(0),E=(0,a.useRef)(null),L=(0,a.useRef)(null),$=v.trim()?g.filter(e=>e.nombre.toLowerCase().includes(v.toLowerCase().trim())):g;if(b[0]!==g||b[1]!==v){let e;b[3]!==v?(e=e=>e.nombre.toLowerCase()===v.toLowerCase().trim(),b[3]=v,b[4]=e):e=b[4],n=g.some(e),b[0]=g,b[1]=v,b[2]=n}else n=b[2];let D=n;b[5]!==D||b[6]!==v?(o=v.trim()&&!D,b[5]=D,b[6]=v,b[7]=o):o=b[7];let M=o;b[8]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{let e=function(e){E.current&&!E.current.contains(e.target)&&k(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},c=[],b[8]=i,b[9]=c):(i=b[8],c=b[9]),(0,a.useEffect)(i,c),b[10]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{S(0)},b[10]=d):d=b[10],b[11]!==v?(m=[v],b[11]=v,b[12]=m):m=b[12],(0,a.useEffect)(d,m);let P=function(e){let t=$.length+ +!!M;if("ArrowDown"===e.key)e.preventDefault(),k(!0),S(e=>(e+1)%t);else if("ArrowUp"===e.key)e.preventDefault(),k(!0),S(e=>(e-1+t)%t);else if("Enter"===e.key&&w)if(e.preventDefault(),M&&0===C)k(!1);else{let e=M?C-1:C;$[e]&&(j($[e].nombre),k(!1))}else"Escape"===e.key&&k(!1)},_=function(e){j(e),k(!1),L.current?.focus()};b[13]===Symbol.for("react.memo_cache_sentinel")?(u=(0,t.jsx)(l.User,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),b[13]=u):u=b[13],b[14]!==j?(x=e=>{j(e.target.value),k(!0)},b[14]=j,b[15]=x):x=b[15],b[16]===Symbol.for("react.memo_cache_sentinel")?(h=()=>k(!0),b[16]=h):h=b[16],b[17]!==P||b[18]!==N||b[19]!==x||b[20]!==v?(p=(0,t.jsxs)("div",{className:"relative",children:[u,(0,t.jsx)("input",{ref:L,type:"text",value:v,onChange:x,onFocus:h,onKeyDown:P,placeholder:N,className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),b[17]=P,b[18]=N,b[19]=x,b[20]=v,b[21]=p):p=b[21];let U=w&&($.length>0||M)&&(0,t.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-slate-800 border border-slate-600 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:[M&&(0,t.jsxs)("button",{type:"button",onClick:()=>{k(!1)},className:`w-full px-4 py-3 flex items-center gap-3 text-left transition-colors border-b border-slate-700 ${0===C?"bg-blue-600/30":"hover:bg-slate-700/50"}`,children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-600/30 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(r.Plus,{className:"w-4 h-4 text-green-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-green-400 font-medium",children:"Crear nuevo cliente"}),(0,t.jsxs)("p",{className:"text-slate-300 font-medium",children:['"',v.trim(),'"']})]})]}),$.map((e,s)=>{let a=M?s+1:s;return(0,t.jsxs)("button",{type:"button",onClick:()=>_(e.nombre),className:`w-full px-4 py-3 flex items-center gap-3 text-left transition-colors ${C===a?"bg-slate-700":"hover:bg-slate-700/50"}`,children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.User,{className:"w-4 h-4 text-slate-300"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-slate-100 font-medium truncate",children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Cliente registrado"})]})]},e.id)}),0===$.length&&!M&&(0,t.jsx)("div",{className:"px-4 py-3 text-center text-slate-400 text-sm",children:"No se encontraron clientes"})]});return b[22]!==p||b[23]!==U?(f=(0,t.jsxs)("div",{ref:E,className:"relative",children:[p,U]}),b[22]=p,b[23]=U,b[24]=f):f=b[24],f}e.s(["ClienteSearch",()=>n],64601),e.s([],16787)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},12426,e=>{"use strict";let t=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],12426)},98646,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75254);let l=(0,a.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),r=(0,a.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var n=e.i(12426),o=e.i(25652),i=e.i(31278),c=e.i(7471);e.i(16787);var d=e.i(59544),m=e.i(3812),u=e.i(39964),x=e.i(91193);function h(){let{tasas:e,refetchTasas:a,monedaActual:h,setMonedaActual:p}=(0,x.useMoneda)(),[f,b]=(0,s.useState)({}),[g,v]=(0,s.useState)(!1),[j,y]=(0,s.useState)(!1),[N,w]=(0,s.useState)(null);async function k(){v(!0),w(null);try{for(let t of e){let e=parseFloat(f[t.moneda]||t.tasa.toString());if(e!==t.tasa){let{error:s}=await c.supabase.from("tasas_cambio").update({tasa:e,updated_at:new Date().toISOString()}).eq("moneda",t.moneda);if(s)throw s}}await a(),w({tipo:"success",texto:"Tasas actualizadas correctamente"})}catch(e){console.error("Error saving tasas:",e),w({tipo:"error",texto:"Error al guardar las tasas"})}finally{v(!1)}}async function C(){y(!0),w(null);try{let e=await fetch("https://api.exchangerate-api.com/v4/latest/USD");if(!e.ok)throw Error("Error al consultar API");let t=await e.json(),s={...f};t.rates.COP&&(s.COP=t.rates.COP.toFixed(2)),t.rates.VES&&(s.VES=t.rates.VES.toFixed(2)),b(s),w({tipo:"success",texto:"Tasas obtenidas de la API. Haz clic en Guardar para aplicar los cambios."})}catch(e){console.error("Error fetching from API:",e),w({tipo:"error",texto:"Error al consultar la API. Puedes ingresar las tasas manualmente."})}finally{y(!1)}}return(0,s.useEffect)(()=>{let t={};e.forEach(e=>{t[e.moneda]=e.tasa.toString()}),b(t)},[e]),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsx)("p",{className:"text-slate-400 text-sm sm:text-base",children:"Configura las tasas de cambio para tu negocio"}),(0,t.jsxs)(d.Button,{onClick:C,disabled:j,variant:"secondary",className:"w-full sm:w-auto",children:[j?(0,t.jsx)(i.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}):(0,t.jsx)(l,{className:"w-4 h-4 mr-2"}),"Obtener del Banco Central de Venezuela"]})]}),N&&(0,t.jsx)("div",{className:`p-4 rounded-lg ${"success"===N.tipo?"bg-green-900/50 text-green-400":"bg-red-900/50 text-red-400"}`,children:N.texto}),(0,t.jsxs)(u.Card,{children:[(0,t.jsx)(u.CardHeader,{children:(0,t.jsxs)("h3",{className:"text-lg font-semibold text-slate-100 flex items-center gap-2",children:[(0,t.jsx)(n.DollarSign,{className:"w-5 h-5 text-green-400"}),"Moneda de Visualización"]})}),(0,t.jsxs)(u.CardContent,{children:[(0,t.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Selecciona en qué moneda quieres ver los precios en la aplicación. Los precios base siempre se guardan en USD."}),(0,t.jsx)("div",{className:"flex flex-wrap gap-3",children:e.map(e=>(0,t.jsxs)("button",{onClick:()=>p(e.moneda),className:`px-4 py-2 rounded-lg border transition-colors ${h===e.moneda?"bg-blue-600 border-blue-500 text-white":"bg-slate-700 border-slate-600 text-slate-300 hover:bg-slate-600"}`,children:[e.simbolo," ",e.moneda]},e.moneda))})]})]}),(0,t.jsxs)(u.Card,{children:[(0,t.jsx)(u.CardHeader,{children:(0,t.jsxs)("h3",{className:"text-lg font-semibold text-slate-100 flex items-center gap-2",children:[(0,t.jsx)(o.TrendingUp,{className:"w-5 h-5 text-blue-400"}),"Tasas de Cambio (Base: 1 USD)"]})}),(0,t.jsxs)(u.CardContent,{children:[(0,t.jsx)("div",{className:"space-y-4",children:e.map(e=>{var s;return(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 p-4 bg-slate-700/50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg font-bold text-slate-100",children:e.moneda}),(0,t.jsx)("span",{className:"text-slate-400",children:"-"}),(0,t.jsx)("span",{className:"text-slate-300",children:e.nombre})]}),(0,t.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["Última actualización: ",(s=e.updated_at)?new Date(s).toLocaleString("es-CO",{dateStyle:"medium",timeStyle:"short"}):"Nunca"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-1 sm:w-48",children:"USD"===e.moneda?(0,t.jsx)("div",{className:"px-3 py-2 bg-slate-600 rounded-lg text-slate-300 text-right",children:"1.00 (Base)"}):(0,t.jsx)(m.Input,{type:"number",step:"0.01",min:"0",value:f[e.moneda]||"",onChange:t=>b({...f,[e.moneda]:t.target.value}),className:"text-right"})}),(0,t.jsxs)("div",{className:"text-slate-400 text-sm w-20 sm:w-24 text-right shrink-0",children:[e.simbolo," por USD"]})]})]},e.moneda)})}),(0,t.jsx)("div",{className:"flex justify-end mt-6",children:(0,t.jsxs)(d.Button,{onClick:k,disabled:g,variant:"success",className:"w-full sm:w-auto",children:[g?(0,t.jsx)(i.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}):(0,t.jsx)(r,{className:"w-4 h-4 mr-2"}),"Guardar Cambios"]})})]})]}),(0,t.jsx)(u.Card,{children:(0,t.jsx)(u.CardContent,{children:(0,t.jsxs)("div",{className:"text-sm text-slate-400 space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{className:"text-slate-300",children:"Nota:"})," Los precios de los productos se almacenan en USD (dólares)."]}),(0,t.jsx)("p",{children:"Las tasas de cambio se usan para mostrar los precios en la moneda que selecciones."}),(0,t.jsx)("p",{children:"Puedes obtener las tasas actualizadas automáticamente desde la API o ingresarlas manualmente."})]})})})]})}e.s(["default",()=>h],98646)}]);