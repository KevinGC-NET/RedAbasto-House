(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},59544,3812,67073,32098,39964,6661,e=>{"use strict";var t=e.i(43476),s=e.i(932);function a(e){let a,l,r,n,o,i,c,d,x=(0,s.c)(12);x[0]!==e?({children:a,variant:r,size:n,className:o,...l}=e,x[0]=e,x[1]=a,x[2]=l,x[3]=r,x[4]=n,x[5]=o):(a=x[1],l=x[2],r=x[3],n=x[4],o=x[5]);let m=void 0===r?"primary":r,u=void 0===n?"md":n,h=void 0===o?"":o;x[6]===Symbol.for("react.memo_cache_sentinel")?(i={primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-slate-700 hover:bg-slate-600 text-slate-200",danger:"bg-red-600 hover:bg-red-700 text-white",success:"bg-green-600 hover:bg-green-700 text-white"},x[6]=i):i=x[6];let p=i;x[7]===Symbol.for("react.memo_cache_sentinel")?(c={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},x[7]=c):c=x[7];let b=c,g=`inline-flex items-center justify-center font-medium rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap ${p[m]} ${b[u]} ${h}`;return x[8]!==a||x[9]!==l||x[10]!==g?(d=(0,t.jsx)("button",{className:g,...l,children:a}),x[8]=a,x[9]=l,x[10]=g,x[11]=d):d=x[11],d}e.s(["Button",()=>a],59544);var l=e.i(71645);let r=(0,l.forwardRef)(({label:e,error:s,className:a="",...l},r)=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:e}),(0,t.jsx)("input",{ref:r,className:`w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${s?"border-red-500":""} ${a}`,...l}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:s})]}));r.displayName="Input",e.s(["Input",0,r],3812);let n=(0,l.forwardRef)(({label:e,error:s,options:a,className:l="",...r},n)=>(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:e}),(0,t.jsxs)("select",{ref:n,className:`w-full px-3 py-2.5 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors cursor-pointer appearance-none bg-no-repeat bg-right pr-10 ${s?"border-red-500":""} ${l}`,style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2394a3b8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\")",backgroundSize:"1.5rem",backgroundPosition:"right 0.5rem center"},...r,children:[(0,t.jsx)("option",{value:"",disabled:!0,className:"bg-slate-800 text-slate-400",children:"Seleccionar..."}),a.map(e=>(0,t.jsx)("option",{value:e.value,className:"bg-slate-800 text-slate-100 py-2",children:e.label},e.value))]}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:s})]}));n.displayName="Select",e.s(["Select",0,n],67073);var o=e.i(37727);function i(e){let a,r,n,i,c,d,x,m,u,h,p=(0,s.c)(22),{isOpen:b,onClose:g,title:f,children:j}=e;return(p[0]!==b||p[1]!==g?(a=()=>{let e=e=>{"Escape"===e.key&&g()};return b&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},r=[b,g],p[0]=b,p[1]=g,p[2]=a,p[3]=r):(a=p[2],r=p[3]),(0,l.useEffect)(a,r),b)?(p[4]!==g?(n=(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:g}),p[4]=g,p[5]=n):n=p[5],p[6]!==f?(i=(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-100",children:f}),p[6]=f,p[7]=i):i=p[7],p[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)(o.X,{className:"w-5 h-5 text-slate-400"}),p[8]=c):c=p[8],p[9]!==g?(d=(0,t.jsx)("button",{onClick:g,className:"p-1 rounded-lg hover:bg-slate-700 transition-colors",children:c}),p[9]=g,p[10]=d):d=p[10],p[11]!==i||p[12]!==d?(x=(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-700",children:[i,d]}),p[11]=i,p[12]=d,p[13]=x):x=p[13],p[14]!==j?(m=(0,t.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:j}),p[14]=j,p[15]=m):m=p[15],p[16]!==x||p[17]!==m?(u=(0,t.jsxs)("div",{className:"relative bg-slate-800 rounded-xl shadow-2xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden",children:[x,m]}),p[16]=x,p[17]=m,p[18]=u):u=p[18],p[19]!==n||p[20]!==u?(h=(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n,u]}),p[19]=n,p[20]=u,p[21]=h):h=p[21],h):null}function c(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,o=`bg-slate-800 rounded-xl border border-slate-700 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==o?(a=(0,t.jsx)("div",{className:o,children:r}),l[0]=r,l[1]=o,l[2]=a):a=l[2],a}function d(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,o=`px-6 py-4 border-b border-slate-700 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==o?(a=(0,t.jsx)("div",{className:o,children:r}),l[0]=r,l[1]=o,l[2]=a):a=l[2],a}function x(e){let a,l=(0,s.c)(3),{children:r,className:n}=e,o=`p-6 ${void 0===n?"":n}`;return l[0]!==r||l[1]!==o?(a=(0,t.jsx)("div",{className:o,children:r}),l[0]=r,l[1]=o,l[2]=a):a=l[2],a}e.s(["Modal",()=>i],32098),e.s(["Card",()=>c,"CardContent",()=>x,"CardHeader",()=>d],39964);let m=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var u=e.i(31278),h=e.i(7471);function p({value:e,onChange:s,onRemove:a}){let[r,n]=(0,l.useState)(!1),[i,c]=(0,l.useState)(null),d=(0,l.useRef)(null);async function x(e){let t=e.target.files?.[0];if(t){if(!t.type.startsWith("image/"))return void c("Solo se permiten im치genes");if(t.size>5242880)return void c("La imagen no debe superar 5MB");n(!0),c(null);try{let e=t.name.split(".").pop(),a=`${Date.now()}-${Math.random().toString(36).substring(2)}.${e}`,l=`productos/${a}`,{error:r}=await h.supabase.storage.from("imagenes").upload(l,t);if(r)throw r;let{data:n}=h.supabase.storage.from("imagenes").getPublicUrl(l);s(n.publicUrl)}catch(e){console.error("Error uploading image:",e),c(e.message||"Error al subir la imagen")}finally{n(!1),d.current&&(d.current.value="")}}}async function p(){if(!e)return;let t=e.split("/imagenes/");if(t.length>1){let e=t[1];await h.supabase.storage.from("imagenes").remove([e])}a?.(),s("")}return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Imagen del producto"}),e?(0,t.jsxs)("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border border-slate-600",children:[(0,t.jsx)("img",{src:e,alt:"Producto",className:"w-full h-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:p,className:"absolute top-2 right-2 p-1.5 bg-red-600 hover:bg-red-700 rounded-full transition-colors",children:(0,t.jsx)(o.X,{className:"w-4 h-4 text-white"})})]}):(0,t.jsxs)("label",{className:`flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-slate-600 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-slate-800/50 transition-colors ${r?"pointer-events-none opacity-50":""}`,children:[(0,t.jsx)("input",{ref:d,type:"file",accept:"image/*",onChange:x,className:"hidden",disabled:r}),r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Loader2,{className:"w-10 h-10 text-blue-500 animate-spin mb-2"}),(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"Subiendo imagen..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-3 bg-slate-700 rounded-full mb-3",children:(0,t.jsx)(m,{className:"w-6 h-6 text-slate-400"})}),(0,t.jsx)("span",{className:"text-sm text-slate-300 font-medium",children:"Clic para subir imagen"}),(0,t.jsx)("span",{className:"text-xs text-slate-500 mt-1",children:"PNG, JPG hasta 5MB"})]})]}),i&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-400",children:i})]})}e.s(["ImageUpload",()=>p],6661)},38378,84614,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(55436),l=e.i(88844),r=e.i(37727);function n({productos:e,onSelect:n,formatearPrecio:o}){let[i,c]=(0,s.useState)(""),[d,x]=(0,s.useState)(!1),[m,u]=(0,s.useState)(0),h=(0,s.useRef)(null),p=(0,s.useRef)(null),b=i.trim()?e.filter(e=>e.nombre.toLowerCase().includes(i.toLowerCase())||e.descripcion?.toLowerCase().includes(i.toLowerCase())).slice(0,8):e.slice(0,8);function g(e){e.stock<=0||(n(e),c(""),h.current?.focus(),x(!1))}return(0,s.useEffect)(()=>{u(0)},[i]),(0,s.useEffect)(()=>{if(m>=0&&p.current){let e=p.current.children[m];e&&e.scrollIntoView({block:"nearest"})}},[m]),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,t.jsx)("input",{ref:h,type:"text",value:i,onChange:e=>{c(e.target.value),x(!0)},onFocus:()=>x(!0),onKeyDown:function(e){if(!d){("ArrowDown"===e.key||"Enter"===e.key)&&x(!0);return}switch(e.key){case"ArrowDown":e.preventDefault(),u(e=>e<b.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),u(e=>e>0?e-1:0);break;case"Enter":e.preventDefault(),b[m]&&g(b[m]);break;case"Escape":x(!1)}},placeholder:"Buscar producto por nombre...",className:"w-full pl-10 pr-10 py-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),i&&(0,t.jsx)("button",{type:"button",onClick:()=>{c(""),h.current?.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-600 rounded",children:(0,t.jsx)(r.X,{className:"w-4 h-4 text-slate-400"})})]}),d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),(0,t.jsxs)("div",{ref:p,className:"absolute z-20 w-full mt-2 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-80 overflow-y-auto",children:[0===b.length?(0,t.jsx)("div",{className:"p-4 text-center text-slate-400",children:"No se encontraron productos"}):b.map((e,s)=>(0,t.jsxs)("button",{type:"button",onClick:()=>g(e),disabled:e.stock<=0,className:`w-full flex items-center gap-3 p-3 text-left transition-colors ${s===m?"bg-blue-600/30":"hover:bg-slate-700/50"} ${e.stock<=0?"opacity-50 cursor-not-allowed":""} ${s!==b.length-1?"border-b border-slate-700/50":""}`,children:[e.imagen_url?(0,t.jsx)("img",{src:e.imagen_url,alt:e.nombre,className:"w-12 h-12 rounded-lg object-cover flex-shrink-0"}):(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg bg-slate-700 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.Package,{className:"w-6 h-6 text-slate-500"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-slate-100 truncate",children:e.nombre}),e.descripcion&&(0,t.jsx)("p",{className:"text-sm text-slate-400 truncate",children:e.descripcion}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-green-400",children:o(e.precio)}),(0,t.jsx)("span",{className:`text-xs px-1.5 py-0.5 rounded ${e.stock>10?"bg-green-900/50 text-green-400":e.stock>0?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:e.stock>0?`Stock: ${e.stock}`:"Sin stock"})]})]})]},e.id)),e.length>8&&!i&&(0,t.jsxs)("div",{className:"p-2 text-center text-xs text-slate-500 border-t border-slate-700",children:["Escribe para buscar entre ",e.length," productos"]})]})]})]})}e.s(["ProductSearch",()=>n],38378);let o=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>o],84614)},16787,64601,e=>{"use strict";e.i(59544),e.i(3812),e.i(67073),e.i(32098),e.i(39964),e.i(6661),e.i(38378);var t=e.i(43476),s=e.i(932),a=e.i(71645),l=e.i(84614),r=e.i(7233);function n(e){let n,o,i,c,d,x,m,u,h,p,b,g=(0,s.c)(25),{clientes:f,value:j,onChange:v,placeholder:N}=e,y=void 0===N?"Buscar o escribir nombre del cliente...":N,[w,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(0),_=(0,a.useRef)(null),D=(0,a.useRef)(null),$=j.trim()?f.filter(e=>e.nombre.toLowerCase().includes(j.toLowerCase().trim())):f;if(g[0]!==f||g[1]!==j){let e;g[3]!==j?(e=e=>e.nombre.toLowerCase()===j.toLowerCase().trim(),g[3]=j,g[4]=e):e=g[4],n=f.some(e),g[0]=f,g[1]=j,g[2]=n}else n=g[2];let E=n;g[5]!==E||g[6]!==j?(o=j.trim()&&!E,g[5]=E,g[6]=j,g[7]=o):o=g[7];let P=o;g[8]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{let e=function(e){_.current&&!_.current.contains(e.target)&&k(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},c=[],g[8]=i,g[9]=c):(i=g[8],c=g[9]),(0,a.useEffect)(i,c),g[10]===Symbol.for("react.memo_cache_sentinel")?(d=()=>{S(0)},g[10]=d):d=g[10],g[11]!==j?(x=[j],g[11]=j,g[12]=x):x=g[12],(0,a.useEffect)(d,x);let M=function(e){let t=$.length+ +!!P;if("ArrowDown"===e.key)e.preventDefault(),k(!0),S(e=>(e+1)%t);else if("ArrowUp"===e.key)e.preventDefault(),k(!0),S(e=>(e-1+t)%t);else if("Enter"===e.key&&w)if(e.preventDefault(),P&&0===C)k(!1);else{let e=P?C-1:C;$[e]&&(v($[e].nombre),k(!1))}else"Escape"===e.key&&k(!1)},F=function(e){v(e),k(!1),D.current?.focus()};g[13]===Symbol.for("react.memo_cache_sentinel")?(m=(0,t.jsx)(l.User,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),g[13]=m):m=g[13],g[14]!==v?(u=e=>{v(e.target.value),k(!0)},g[14]=v,g[15]=u):u=g[15],g[16]===Symbol.for("react.memo_cache_sentinel")?(h=()=>k(!0),g[16]=h):h=g[16],g[17]!==M||g[18]!==y||g[19]!==u||g[20]!==j?(p=(0,t.jsxs)("div",{className:"relative",children:[m,(0,t.jsx)("input",{ref:D,type:"text",value:j,onChange:u,onFocus:h,onKeyDown:M,placeholder:y,className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),g[17]=M,g[18]=y,g[19]=u,g[20]=j,g[21]=p):p=g[21];let L=w&&($.length>0||P)&&(0,t.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-slate-800 border border-slate-600 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:[P&&(0,t.jsxs)("button",{type:"button",onClick:()=>{k(!1)},className:`w-full px-4 py-3 flex items-center gap-3 text-left transition-colors border-b border-slate-700 ${0===C?"bg-blue-600/30":"hover:bg-slate-700/50"}`,children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-600/30 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(r.Plus,{className:"w-4 h-4 text-green-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-green-400 font-medium",children:"Crear nuevo cliente"}),(0,t.jsxs)("p",{className:"text-slate-300 font-medium",children:['"',j.trim(),'"']})]})]}),$.map((e,s)=>{let a=P?s+1:s;return(0,t.jsxs)("button",{type:"button",onClick:()=>F(e.nombre),className:`w-full px-4 py-3 flex items-center gap-3 text-left transition-colors ${C===a?"bg-slate-700":"hover:bg-slate-700/50"}`,children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(l.User,{className:"w-4 h-4 text-slate-300"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-slate-100 font-medium truncate",children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Cliente registrado"})]})]},e.id)}),0===$.length&&!P&&(0,t.jsx)("div",{className:"px-4 py-3 text-center text-slate-400 text-sm",children:"No se encontraron clientes"})]});return g[22]!==p||g[23]!==L?(b=(0,t.jsxs)("div",{ref:_,className:"relative",children:[p,L]}),g[22]=p,g[23]=L,g[24]=b):b=g[24],b}e.s(["ClienteSearch",()=>n],64601),e.s([],16787)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},12426,e=>{"use strict";let t=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],12426)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},73375,63059,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>s],73375);let a=(0,t.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>a],63059)},83164,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(7233),l=e.i(1928),r=e.i(75254);let n=(0,r.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var o=e.i(27612);let i=(0,r.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var c=e.i(12426);let d=(0,r.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),x=(0,r.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),m=(0,r.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var u=e.i(63209),h=e.i(55436),p=e.i(87316),b=e.i(73375),g=e.i(63059),f=e.i(37727),j=e.i(7471);e.i(16787);var v=e.i(59544),N=e.i(3812),y=e.i(32098),w=e.i(39964),k=e.i(67073),C=e.i(38378),S=e.i(64601),_=e.i(91193);function D(){let[e,r]=(0,s.useState)([]),[D,$]=(0,s.useState)([]),[E,P]=(0,s.useState)([]),[M,F]=(0,s.useState)(!0),[L,U]=(0,s.useState)(!1),[T,B]=(0,s.useState)(null),[R,A]=(0,s.useState)(null),[z,V]=(0,s.useState)(""),[O,q]=(0,s.useState)(""),[H,I]=(0,s.useState)([]),[X,K]=(0,s.useState)(""),[Y,G]=(0,s.useState)("USD"),[J,W]=(0,s.useState)("efectivo"),[Z,Q]=(0,s.useState)(""),[ee,et]=(0,s.useState)(""),[es,ea]=(0,s.useState)(""),[el,er]=(0,s.useState)("all"),[en,eo]=(0,s.useState)("all"),[ei,ec]=(0,s.useState)(""),[ed,ex]=(0,s.useState)(""),[em,eu]=(0,s.useState)(!1),[eh,ep]=(0,s.useState)(1),[eb,eg]=(0,s.useState)({}),{formatearPrecio:ef,tasas:ej,getTasa:ev}=(0,_.useMoneda)();async function eN(){let[e,t,s,a]=await Promise.all([j.supabase.from("ventas").select("*").order("created_at",{ascending:!1}),j.supabase.from("productos").select("*").order("nombre"),j.supabase.from("venta_items").select("venta_id, producto_nombre"),j.supabase.from("clientes").select("*").order("nombre")]);if(e.error?console.error("Error fetching ventas:",e.error):r(e.data||[]),t.error?console.error("Error fetching productos:",t.error):$(t.data||[]),a.error?console.error("Error fetching clientes:",a.error):P(a.data||[]),s.data){let e={};s.data.forEach(t=>{e[t.venta_id]||(e[t.venta_id]=[]),e[t.venta_id].push(t.producto_nombre.toLowerCase())}),eg(e)}F(!1)}(0,s.useEffect)(()=>{eN()},[]);let ey=(0,s.useMemo)(()=>{let t=[...e];if(ee.trim()){let e=ee.toLowerCase().trim();t=t.filter(t=>t.cliente_nombre.toLowerCase().includes(e))}if(es.trim()){let e=es.toLowerCase().trim();t=t.filter(t=>(eb[t.id]||[]).some(t=>t.includes(e)))}if("all"!==el&&(t=t.filter(e=>(e.estado||"pendiente")===el)),"all"!==en){let{start:e,end:s}=function(e){let t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case"today":return{start:s,end:new Date(s.getTime()+864e5)};case"week":{let e=new Date(s);return e.setDate(s.getDate()-s.getDay()),{start:e,end:new Date(s.getTime()+864e5)}}case"month":return{start:new Date(s.getFullYear(),s.getMonth(),1),end:new Date(s.getTime()+864e5)};case"year":return{start:new Date(s.getFullYear(),0,1),end:new Date(s.getTime()+864e5)};case"custom":return{start:ei?new Date(ei):null,end:ed?new Date(new Date(ed).getTime()+864e5):null};default:return{start:null,end:null}}}(en);e&&(t=t.filter(t=>new Date(t.created_at)>=e)),s&&(t=t.filter(e=>new Date(e.created_at)<s))}return t},[e,ee,es,el,en,ei,ed,eb]),ew=Math.ceil(ey.length/10),ek=(0,s.useMemo)(()=>{let e=(eh-1)*10;return ey.slice(e,e+10)},[ey,eh]);function eC(){et(""),ea(""),er("all"),eo("all"),ec(""),ex("")}(0,s.useEffect)(()=>{ep(1)},[ee,es,el,en,ei,ed]);let eS=ee||es||"all"!==el||"all"!==en;async function e_(e){let[t,s,a]=await Promise.all([j.supabase.from("ventas").select("*").eq("id",e).single(),j.supabase.from("venta_items").select("*").eq("venta_id",e),j.supabase.from("pagos").select("*").eq("venta_id",e).order("created_at",{ascending:!1})]);return t.error?(console.error("Error fetching venta:",t.error),null):{...t.data,items:s.data||[],pagos:a.data||[]}}async function eD(e){let t=await e_(e.id);t&&B(t)}async function e$(e){let t=await e_(e.id);t&&(A(t),K(""),G("USD"),W("efectivo"),Q(""))}function eE(e){I(H.filter(t=>t.producto.id!==e))}function eP(e,t){if(t<1)return void eE(e);let s=H.find(t=>t.producto.id===e);if(s){if(t>s.producto.stock)return void alert(`Stock insuficiente. Solo hay ${s.producto.stock} unidades disponibles.`);I(H.map(s=>s.producto.id===e?{...s,cantidad:t}:s))}}function eM(){return H.reduce((e,t)=>e+t.producto.precio*t.cantidad,0)}function eF(){U(!1),V(""),q(""),I([])}async function eL(e){if(e.preventDefault(),0===H.length||!z.trim())return;let t=eM(),s=z.trim();if(!E.some(e=>e.nombre.toLowerCase()===s.toLowerCase())){let{error:e}=await j.supabase.from("clientes").insert({nombre:s});e&&!e.message.includes("duplicate")&&console.error("Error creating cliente:",e)}let a=ev("COP")?.tasa||1,l=ev("VES")?.tasa||1,{data:r,error:n}=await j.supabase.from("ventas").insert({cliente_nombre:s,total:t,notas:O||null,tasa_usd_cop:a,tasa_usd_ves:l,moneda_venta:"USD",total_pagado:0,estado:"pendiente"}).select().single();if(n)return void console.error("Error creating venta:",n);let o=H.map(e=>({venta_id:r.id,producto_id:e.producto.id,producto_nombre:e.producto.nombre,cantidad:e.cantidad,precio_unitario:e.producto.precio,subtotal:e.producto.precio*e.cantidad})),{error:i}=await j.supabase.from("venta_items").insert(o);if(i)return void console.error("Error creating venta items:",i);for(let e of H)await j.supabase.from("productos").update({stock:e.producto.stock-e.cantidad}).eq("id",e.producto.id);eF(),eN()}async function eU(e){if(e.preventDefault(),!R||!X)return;let t=parseFloat(X),s=ev(Y)?.tasa||1,a="USD"===Y?t:t/s,{error:l}=await j.supabase.from("pagos").insert({venta_id:R.id,monto:t,moneda:Y,tasa_momento:s,monto_usd:a,metodo_pago:J,referencia:Z||null});l?console.error("Error registrando pago:",l):(A(null),eN())}async function eT(e){if(!confirm("쮼st치s seguro de eliminar esta venta?"))return;let{error:t}=await j.supabase.from("ventas").delete().eq("id",e);t?console.error("Error deleting venta:",t):eN()}function eB(e){return new Date(e).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function eR(e){switch(e){case"pagada":return(0,t.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 bg-green-900/50 text-green-400 rounded-md text-xs",children:[(0,t.jsx)(x,{className:"w-3 h-3"})," Pagada"]});case"parcial":return(0,t.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-900/50 text-yellow-400 rounded-md text-xs",children:[(0,t.jsx)(m,{className:"w-3 h-3"})," Parcial"]});default:return(0,t.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 bg-red-900/50 text-red-400 rounded-md text-xs",children:[(0,t.jsx)(u.AlertCircle,{className:"w-3 h-3"})," Pendiente"]})}}return M?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"text-slate-400",children:"Cargando..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsx)("p",{className:"text-slate-400 text-sm sm:text-base",children:"Registra y consulta tus ventas"}),(0,t.jsxs)(v.Button,{onClick:()=>U(!0),className:"w-full sm:w-auto",children:[(0,t.jsx)(a.Plus,{className:"w-4 h-4 mr-2"}),"Nueva Venta"]})]}),(0,t.jsx)(w.Card,{children:(0,t.jsxs)(w.CardContent,{className:"py-4",children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar por cliente...",value:ee,onChange:e=>et(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar por producto...",value:es,onChange:e=>ea(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,t.jsx)("div",{className:"w-full lg:w-48",children:(0,t.jsxs)("select",{value:el,onChange:e=>er(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"all",children:"Todos los estados"}),(0,t.jsx)("option",{value:"pendiente",children:"Pendiente"}),(0,t.jsx)("option",{value:"parcial",children:"Parcial"}),(0,t.jsx)("option",{value:"pagada",children:"Pagada"})]})}),(0,t.jsxs)("button",{onClick:()=>eu(!em),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors ${em||"all"!==en?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[(0,t.jsx)(p.Calendar,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Fechas"}),"all"!==en&&(0,t.jsx)("span",{className:"w-2 h-2 bg-white rounded-full"})]})]}),em&&(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:[{value:"all",label:"Todas"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"year",label:"Este a침o"},{value:"custom",label:"Personalizado"}].map(e=>(0,t.jsx)("button",{onClick:()=>eo(e.value),className:`px-3 py-1.5 rounded-lg text-sm transition-colors ${en===e.value?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:e.label},e.value))}),"custom"===en&&(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Desde"}),(0,t.jsx)("input",{type:"date",value:ei,onChange:e=>ec(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Hasta"}),(0,t.jsx)("input",{type:"date",value:ed,onChange:e=>ex(e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),eS&&(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-700 flex flex-wrap items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"Filtros activos:"}),ee&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-900/50 text-blue-300 rounded text-xs",children:["Cliente: ",ee,(0,t.jsx)("button",{onClick:()=>et(""),className:"hover:text-blue-100",children:(0,t.jsx)(f.X,{className:"w-3 h-3"})})]}),es&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-900/50 text-blue-300 rounded text-xs",children:["Producto: ",es,(0,t.jsx)("button",{onClick:()=>ea(""),className:"hover:text-blue-100",children:(0,t.jsx)(f.X,{className:"w-3 h-3"})})]}),"all"!==el&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-900/50 text-blue-300 rounded text-xs",children:["Estado: ",el,(0,t.jsx)("button",{onClick:()=>er("all"),className:"hover:text-blue-100",children:(0,t.jsx)(f.X,{className:"w-3 h-3"})})]}),"all"!==en&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-900/50 text-blue-300 rounded text-xs",children:["Fecha: ","custom"===en?"Personalizado":"today"===en?"Hoy":"week"===en?"Esta semana":"month"===en?"Este mes":"Este a침o",(0,t.jsx)("button",{onClick:()=>eo("all"),className:"hover:text-blue-100",children:(0,t.jsx)(f.X,{className:"w-3 h-3"})})]}),(0,t.jsx)("button",{onClick:eC,className:"text-xs text-red-400 hover:text-red-300 ml-2",children:"Limpiar todos"})]}),(0,t.jsxs)("div",{className:"mt-3 text-sm text-slate-400",children:["Mostrando ",ey.length," de ",e.length," ventas"]})]})}),0===ey.length?(0,t.jsx)(w.Card,{children:(0,t.jsxs)(w.CardContent,{className:"text-center py-12",children:[(0,t.jsx)(l.ShoppingCart,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-400",children:0===e.length?"No hay ventas registradas":"No se encontraron ventas con los filtros aplicados"}),0===e.length?(0,t.jsx)(v.Button,{onClick:()=>U(!0),className:"mt-4",children:"Registrar primera venta"}):(0,t.jsx)(v.Button,{onClick:eC,variant:"secondary",className:"mt-4",children:"Limpiar filtros"})]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"hidden lg:block bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-700",children:[(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Fecha"}),(0,t.jsx)("th",{className:"text-left px-6 py-4 text-sm font-medium text-slate-400",children:"Cliente"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Total"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Pagado"}),(0,t.jsx)("th",{className:"text-center px-6 py-4 text-sm font-medium text-slate-400",children:"Estado"}),(0,t.jsx)("th",{className:"text-right px-6 py-4 text-sm font-medium text-slate-400",children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:ek.map(e=>{let s=e.total-(e.total_pagado||0);return(0,t.jsxs)("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30 transition-colors",children:[(0,t.jsx)("td",{className:"px-6 py-4 text-slate-300 text-sm",children:eB(e.created_at)}),(0,t.jsxs)("td",{className:"px-6 py-4",children:[(0,t.jsx)("p",{className:"font-medium text-slate-100",children:e.cliente_nombre}),e.notas&&(0,t.jsx)("p",{className:"text-sm text-slate-400 truncate max-w-xs",children:e.notas})]}),(0,t.jsxs)("td",{className:"px-6 py-4 text-right",children:[(0,t.jsx)("p",{className:"font-semibold text-slate-100",children:ef(e.total)}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["$ ",e.total.toFixed(2)," USD"]})]}),(0,t.jsxs)("td",{className:"px-6 py-4 text-right",children:[(0,t.jsxs)("p",{className:"font-semibold text-green-400",children:["$ ",(e.total_pagado||0).toFixed(2)]}),s>0&&(0,t.jsxs)("p",{className:"text-xs text-red-400",children:["Debe: $ ",s.toFixed(2)]})]}),(0,t.jsx)("td",{className:"px-6 py-4 text-center",children:eR(e.estado||"pendiente")}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex justify-end gap-1",children:["pagada"!==e.estado&&(0,t.jsx)("button",{onClick:()=>e$(e),className:"p-2 hover:bg-green-700/50 rounded-lg transition-colors",title:"Registrar pago",children:(0,t.jsx)(c.DollarSign,{className:"w-4 h-4 text-green-400"})}),(0,t.jsx)("button",{onClick:()=>eD(e),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",title:"Ver detalle",children:(0,t.jsx)(n,{className:"w-4 h-4 text-slate-400"})}),(0,t.jsx)("button",{onClick:()=>eT(e.id),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",title:"Eliminar",children:(0,t.jsx)(o.Trash2,{className:"w-4 h-4 text-red-400"})})]})})]},e.id)})})]})}),(0,t.jsx)("div",{className:"lg:hidden space-y-4",children:ek.map(e=>{let s=e.total-(e.total_pagado||0);return(0,t.jsx)(w.Card,{children:(0,t.jsxs)(w.CardContent,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-slate-100",children:e.cliente_nombre}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:eB(e.created_at)})]}),eR(e.estado||"pendiente")]}),e.notas&&(0,t.jsx)("p",{className:"text-sm text-slate-400 mb-3 truncate",children:e.notas}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Total"}),(0,t.jsx)("p",{className:"font-semibold text-slate-100",children:ef(e.total)}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["$ ",e.total.toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Pagado"}),(0,t.jsxs)("p",{className:"font-semibold text-green-400",children:["$ ",(e.total_pagado||0).toFixed(2)]}),s>0&&(0,t.jsxs)("p",{className:"text-xs text-red-400",children:["Debe: $ ",s.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-3 border-t border-slate-700",children:["pagada"!==e.estado&&(0,t.jsxs)("button",{onClick:()=>e$(e),className:"flex items-center gap-1 px-3 py-1.5 bg-green-700/30 hover:bg-green-700/50 text-green-400 rounded-lg text-sm transition-colors",children:[(0,t.jsx)(c.DollarSign,{className:"w-4 h-4"}),"Pagar"]}),(0,t.jsxs)("button",{onClick:()=>eD(e),className:"flex items-center gap-1 px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg text-sm transition-colors",children:[(0,t.jsx)(n,{className:"w-4 h-4"}),"Ver"]}),(0,t.jsx)("button",{onClick:()=>eT(e.id),className:"p-1.5 hover:bg-slate-700 rounded-lg transition-colors",children:(0,t.jsx)(o.Trash2,{className:"w-4 h-4 text-red-400"})})]})]})},e.id)})}),ew>1&&(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 pt-4",children:[(0,t.jsxs)("p",{className:"text-sm text-slate-400",children:["P치gina ",eh," de ",ew]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>ep(1),disabled:1===eh,className:"px-3 py-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:"Primera"}),(0,t.jsx)("button",{onClick:()=>ep(e=>Math.max(1,e-1)),disabled:1===eh,className:"p-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,t.jsx)(b.ChevronLeft,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,ew)},(e,s)=>{let a;return a=ew<=5||eh<=3?s+1:eh>=ew-2?ew-4+s:eh-2+s,(0,t.jsx)("button",{onClick:()=>ep(a),className:`w-8 h-8 rounded-lg text-sm transition-colors ${eh===a?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:a},a)})}),(0,t.jsx)("button",{onClick:()=>ep(e=>Math.min(ew,e+1)),disabled:eh===ew,className:"p-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,t.jsx)(g.ChevronRight,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>ep(ew),disabled:eh===ew,className:"px-3 py-2 bg-slate-700 rounded-lg text-slate-300 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:"칔ltima"})]})]})]}),(0,t.jsx)(y.Modal,{isOpen:L,onClose:eF,title:"Nueva Venta",children:(0,t.jsxs)("form",{onSubmit:eL,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Nombre del Cliente"}),(0,t.jsx)(S.ClienteSearch,{clientes:E,value:z,onChange:V,placeholder:"Buscar o escribir nombre del cliente..."}),(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Si el cliente no existe, se crear치 autom치ticamente"})]}),(0,t.jsxs)("div",{className:"border-t border-slate-700 pt-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Agregar Productos"}),(0,t.jsx)(C.ProductSearch,{productos:D,onSelect:function(e){let t=H.find(t=>t.producto.id===e.id),s=t?.cantidad||0,a=s+1;a>e.stock?alert(`Stock insuficiente. Solo hay ${e.stock} unidades disponibles${s>0?` (ya tienes ${s} en el carrito)`:""}.`):t?I(H.map(t=>t.producto.id===e.id?{...t,cantidad:a}:t)):I([...H,{producto:e,cantidad:1}])},formatearPrecio:ef}),(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Busca y selecciona productos para agregar al carrito"})]}),H.length>0&&(0,t.jsx)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-slate-700/50",children:[(0,t.jsx)("th",{className:"text-left px-4 py-2 text-sm text-slate-400",children:"Producto"}),(0,t.jsx)("th",{className:"text-center px-4 py-2 text-sm text-slate-400",children:"Cant."}),(0,t.jsx)("th",{className:"text-right px-4 py-2 text-sm text-slate-400",children:"Subtotal"}),(0,t.jsx)("th",{className:"w-10"})]})}),(0,t.jsx)("tbody",{children:H.map(e=>(0,t.jsxs)("tr",{className:"border-t border-slate-700/50",children:[(0,t.jsx)("td",{className:"px-4 py-2 text-slate-200",children:e.producto.nombre}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>eP(e.producto.id,e.cantidad-1),className:"p-1 hover:bg-slate-700 rounded",children:(0,t.jsx)(i,{className:"w-3 h-3 text-slate-400"})}),(0,t.jsx)("span",{className:"w-8 text-center text-slate-200",children:e.cantidad}),(0,t.jsx)("button",{type:"button",onClick:()=>eP(e.producto.id,e.cantidad+1),className:"p-1 hover:bg-slate-700 rounded",children:(0,t.jsx)(a.Plus,{className:"w-3 h-3 text-slate-400"})})]})}),(0,t.jsx)("td",{className:"px-4 py-2 text-right text-slate-200",children:ef(e.producto.precio*e.cantidad)}),(0,t.jsx)("td",{className:"px-2 py-2",children:(0,t.jsx)("button",{type:"button",onClick:()=>eE(e.producto.id),className:"p-1 hover:bg-slate-700 rounded",children:(0,t.jsx)(o.Trash2,{className:"w-4 h-4 text-red-400"})})})]},e.producto.id))}),(0,t.jsx)("tfoot",{children:(0,t.jsxs)("tr",{className:"border-t border-slate-600 bg-slate-700/30",children:[(0,t.jsx)("td",{colSpan:1,className:"px-4 py-3 text-right font-medium text-slate-300",children:"Total:"}),(0,t.jsx)("td",{colSpan:2,className:"px-4 py-3 text-right font-bold text-green-400",children:ef(eM())}),(0,t.jsx)("td",{})]})})]})}),(0,t.jsx)(N.Input,{label:"Notas (opcional)",value:O,onChange:e=>q(e.target.value)}),(0,t.jsxs)("div",{className:"bg-slate-700/30 p-3 rounded-lg text-sm text-slate-400",children:[(0,t.jsx)("p",{children:"Las tasas de cambio actuales se guardar치n con esta venta:"}),(0,t.jsxs)("div",{className:"flex gap-4 mt-1",children:[(0,t.jsxs)("span",{children:["USD: ",ev("USD")?.tasa?.toLocaleString()||"N/A"]}),(0,t.jsxs)("span",{children:["VES: ",ev("VES")?.tasa?.toLocaleString()||"N/A"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(v.Button,{type:"button",variant:"secondary",onClick:eF,children:"Cancelar"}),(0,t.jsx)(v.Button,{type:"submit",variant:"success",disabled:0===H.length,children:"Registrar Venta"})]})]})}),(0,t.jsx)(y.Modal,{isOpen:!!T,onClose:()=>B(null),title:"Detalle de Venta",children:T&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Cliente"}),(0,t.jsx)("p",{className:"text-slate-100 font-medium",children:T.cliente_nombre})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Fecha"}),(0,t.jsx)("p",{className:"text-slate-100",children:eB(T.created_at)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Estado"}),eR(T.estado||"pendiente")]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Tasas al momento"}),(0,t.jsxs)("p",{className:"text-xs text-slate-300",children:["COP: ",T.tasa_usd_cop?.toLocaleString()," | VES: ",T.tasa_usd_ves?.toLocaleString()]})]})]}),T.notas&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Notas"}),(0,t.jsx)("p",{className:"text-slate-300",children:T.notas})]}),(0,t.jsxs)("div",{className:"border-t border-slate-700 pt-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-slate-400 mb-2",children:"Productos"}),(0,t.jsx)("div",{className:"space-y-2",children:T.items?.map(e=>{var s,a;let l;return(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-700/50",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-200",children:e.producto_nombre}),(0,t.jsxs)("p",{className:"text-sm text-slate-400",children:[e.cantidad," x $ ",e.precio_unitario.toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-medium text-slate-200",children:["$ ",e.subtotal.toFixed(2)," USD"]}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:(s=e.subtotal,a=T.tasa_usd_cop||1,l=ev("COP")?.simbolo||"$",`${l} ${(s*a).toLocaleString("es-CO",{minimumFractionDigits:0})} COP`)})]})]},e.id)})})]}),(0,t.jsxs)("div",{className:"border-t border-slate-700 pt-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-slate-400 mb-2",children:"Historial de Pagos"}),T.pagos&&T.pagos.length>0?(0,t.jsx)("div",{className:"space-y-2",children:T.pagos.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 bg-slate-700/30 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-slate-200",children:["efectivo"===e.metodo_pago?"游눳":"游눱"," ",e.metodo_pago]}),(0,t.jsxs)("p",{className:"text-xs text-slate-400",children:[eB(e.created_at),e.referencia&&` - Ref: ${e.referencia}`]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-medium text-green-400",children:[ev(e.moneda)?.simbolo," ",e.monto.toLocaleString()," ",e.moneda]}),(0,t.jsxs)("p",{className:"text-xs text-slate-400",children:["$ ",e.monto_usd.toFixed(2)," USD (tasa: ",e.tasa_momento,")"]})]})]},e.id))}):(0,t.jsx)("p",{className:"text-sm text-slate-500 text-center py-2",children:"Sin pagos registrados"})]}),(0,t.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-slate-300",children:[(0,t.jsx)("span",{children:"Total venta:"}),(0,t.jsxs)("span",{className:"font-medium",children:["$ ",T.total.toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-green-400",children:[(0,t.jsx)("span",{children:"Total pagado:"}),(0,t.jsxs)("span",{className:"font-medium",children:["$ ",(T.total_pagado||0).toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-lg border-t border-slate-600 pt-2",children:[(0,t.jsx)("span",{className:T.total-(T.total_pagado||0)>0?"text-red-400":"text-green-400",children:T.total-(T.total_pagado||0)>0?"Pendiente:":"Saldo:"}),(0,t.jsxs)("span",{className:`font-bold ${T.total-(T.total_pagado||0)>0?"text-red-400":"text-green-400"}`,children:["$ ",Math.abs(T.total-(T.total_pagado||0)).toFixed(2)," USD"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:["pagada"!==T.estado&&(0,t.jsxs)(v.Button,{variant:"success",onClick:()=>{B(null),e$(T)},className:"flex-1",children:[(0,t.jsx)(c.DollarSign,{className:"w-4 h-4 mr-1"}),"Registrar Pago"]}),(0,t.jsx)(v.Button,{variant:"secondary",onClick:()=>B(null),className:"flex-1",children:"Cerrar"})]})]})}),(0,t.jsx)(y.Modal,{isOpen:!!R,onClose:()=>A(null),title:"Registrar Pago",children:R&&(0,t.jsxs)("form",{onSubmit:eU,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-slate-700/50 rounded-lg p-4",children:[(0,t.jsxs)("p",{className:"text-sm text-slate-400",children:["Venta a: ",(0,t.jsx)("span",{className:"text-slate-100",children:R.cliente_nombre})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,t.jsx)("span",{className:"text-slate-400",children:"Total:"}),(0,t.jsxs)("span",{className:"text-slate-100",children:["$ ",R.total.toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-400",children:"Pagado:"}),(0,t.jsxs)("span",{className:"text-green-400",children:["$ ",(R.total_pagado||0).toFixed(2)," USD"]})]}),(0,t.jsxs)("div",{className:"flex justify-between border-t border-slate-600 mt-2 pt-2",children:[(0,t.jsx)("span",{className:"text-slate-300 font-medium",children:"Pendiente:"}),(0,t.jsxs)("span",{className:"text-red-400 font-bold",children:["$ ",(R.total-(R.total_pagado||0)).toFixed(2)," USD"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(N.Input,{label:"Monto",type:"number",step:"0.01",min:"0",value:X,onChange:e=>K(e.target.value),required:!0}),(0,t.jsx)(k.Select,{label:"Moneda",value:Y,onChange:e=>G(e.target.value),options:ej.map(e=>({value:e.moneda,label:`${e.simbolo} ${e.moneda}`}))})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{let e=R.total-(R.total_pagado||0),t=ev(Y)?.tasa||1;K(("USD"===Y?e:e*t).toFixed(2))},className:"w-full py-2 px-4 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-lg text-sm transition-colors",children:["游눯 Pagar todo el restante (","USD"===Y?`$ ${(R.total-(R.total_pagado||0)).toFixed(2)} USD`:`${ev(Y)?.simbolo} ${((R.total-(R.total_pagado||0))*(ev(Y)?.tasa||1)).toLocaleString("es-CO",{minimumFractionDigits:2})} ${Y}`,")"]}),"USD"!==Y&&X&&(0,t.jsxs)("div",{className:"bg-blue-900/30 p-3 rounded-lg text-sm",children:[(0,t.jsxs)("p",{className:"text-blue-400",children:["Equivale a: ",(0,t.jsxs)("strong",{children:["$ ",(parseFloat(X)/(ev(Y)?.tasa||1)).toFixed(2)," USD"]})]}),(0,t.jsxs)("p",{className:"text-blue-300/70 text-xs",children:["Tasa actual: 1 USD = ",ev(Y)?.tasa?.toLocaleString()," ",Y]})]}),(0,t.jsx)(k.Select,{label:"M칠todo de pago",value:J,onChange:e=>W(e.target.value),options:[{value:"efectivo",label:"游눳 Efectivo"},{value:"transferencia",label:"游낁 Transferencia"},{value:"tarjeta",label:"游눱 Tarjeta"},{value:"pago_movil",label:"游님 Pago M칩vil"},{value:"zelle",label:"游눶 Zelle"},{value:"otro",label:"游닇 Otro"}]}),(0,t.jsx)(N.Input,{label:"Referencia (opcional)",value:Z,onChange:e=>Q(e.target.value),placeholder:"N칰mero de transacci칩n, etc."}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(v.Button,{type:"button",variant:"secondary",onClick:()=>A(null),children:"Cancelar"}),(0,t.jsxs)(v.Button,{type:"submit",variant:"success",disabled:!X,children:[(0,t.jsx)(d,{className:"w-4 h-4 mr-1"}),"Registrar Pago"]})]})]})})]})}e.s(["default",()=>D],83164)}]);